---
title: Configuration
description: Configure site metadata, directories, themes, public assets, and CLI overrides.
weight: 2
---

# Configuration

Methanol reads configuration from:

```
methanol.config.{js,mjs,cjs,ts,jsx,tsx,mts,cts}
```

If no config is present, Methanol uses defaults based on the current directory.

## Config Shape

The config file must export a function. The function receives a context object and returns a config object.

```js
export default ({ mode, root, HTMLRenderer }) => ({
	// config values
})
```

Context fields:

- `mode`: `development` or `production`
- `root`: project root
- `HTMLRenderer`: refui HTML utilities (`rawHTML`, `serialize`, etc.)

## Core Options

### `root`

Project root. Defaults to the current working directory.

### `site`

Site metadata used by templates:

- `site.name`: site title
- `site.logo`: logo path (string) or `false` to disable (default theme)
- `site.favicon`: favicon path (string) or `false` to disable (default theme)
- `site.base`: deployment base (path prefix) when the site is served under a subpath (e.g. `'/docs/'`)
- `site.repoBase`: base URL to your content folder in a repo (used by the default theme to build “Edit this page” links)

Notes:

- `site.base` is normalized to a leading and trailing slash (e.g. `docs` → `'/docs/'`).
- `site.base` is used as the default Vite `base` unless you explicitly set `vite.base`.
- In dev (`methanol dev`), `site.base` is ignored and treated as `/` due to Vite module resolution inconsistencies. Verify subpath deployments with `methanol build` + `methanol serve`.

### `pagefind`

Enable or configure Pagefind search. Default: `false`.

```js
pagefind: false
// or
pagefind: { enabled: true }
// or
pagefind: {
	enabled: true,
	excerptLength: 30,
	build: {
		outputSubdir: 'pagefind',
		verbose: true
	}
}
```

Notes:

- Keys other than `enabled` and `build` are forwarded to the Pagefind JS `options()` call.
- `build` is the only build options entry.

### `starryNight`

Controls code highlighting (rehype-starry-night). Default: `false`.

```js
starryNight: false
// or
starryNight: true
// or
starryNight: {
	// options forwarded to rehype-starry-night
}
```

- If `starryNight` is an object, highlighting is enabled unless `enabled: false` is set.
- Per-page frontmatter `starryNight` always overrides this value.
- CLI `--code-highlighting` can enable or disable highlighting for a run.

### `pagesDir`

Where MDX/MD files live (routes). Default: `pages` with a fallback to `docs` if `pages/` does not exist.

### `componentsDir`

Where JSX/TSX components live. Default: `components`.

If you explicitly set `pagesDir` or `componentsDir` (including via CLI), Methanol throws if the directory does not exist.

### `publicDir`

Static assets folder served at the site root (e.g. `public/foo.png` → `/foo.png`). Default: `public`.

Methanol also includes theme public assets (`theme.publicDir`). When both theme and user assets exist, Methanol merges them into a single directory (theme first, then user), so user assets override theme assets on path conflicts.

When merging is needed, the internal merged directory is created under `node_modules/.methanol/assets` (or `{pagesDir}/.methanol/assets` if `node_modules/` does not exist).

Set `publicDir: false` to disable public assets entirely (including theme assets).

### `distDir`

Output folder for production builds. Default: `dist`.

### `buildDir`

Intermediate build directory (used with `emitIntermediate`). Default: `build`.

### `intermediateDir`

Explicit directory to write intermediate HTML output (build only).

### `emitIntermediate`

Boolean. When true, Methanol writes intermediate HTML to `build/` during build.

### `theme`

Theme configuration. See [Advanced themes](../advanced/themes/) for full usage.

Key fields:

- `theme.root`: theme root directory (required)
- `theme.template`: HTML template function (receives `{ ctx, page, PageContent, ExtraHead, withBase, HTMLRenderer, components }`)
- `theme.components`: default MDX components
- `theme.componentsDir`: folder of theme components
- `theme.pagesDir`: folder of theme pages
- `theme.publicDir`: theme public assets (merged into `publicDir`)
- `theme.sources`: virtual file map used by Methanol’s resolver
- `theme.mdx`: default MDX options merged with user `mdx`
- `theme.vite`: default Vite config merged with user `vite`

### `mdx`

Customize MDX compilation. This function receives `{ mode, root }` and should return MDX options.

### `vite`

Merge custom Vite config. This function receives `{ command, mode, root, isPreview }`.

### `preBuild` / `preBundle` / `postBundle` / `postBuild`

Hooks for customizing the build pipeline.

- `preBuild` runs in dev startup and before build.
- `preBundle` runs only during build, after pages are rendered and before Vite bundles assets.
- `postBundle` runs only during build, after Vite bundles assets and before Pagefind indexing.
- `postBuild` runs only after build (not in dev).
- Hooks can be a function or an array of functions.
- Hook order: user `preBuild` → theme `preBuild` → render → user `preBundle` → theme `preBundle` → bundle → theme `postBundle` → user `postBundle` → (optional) Pagefind → theme `postBuild` → user `postBuild`.

Hook context:

- `mode`, `root`, `command`, `isDev`, `isBuild`, `isPreview`
- `HTMLRenderer`
- `site` (same shape as `ctx.site`)
- `data` (mutable object for sharing data between hooks)

Bundle/post-build hooks also receive:

- `pagesContext`
- `pages`
- `pagesTree`
- `pagesByRoute`

Example:

```js
export default () => ({
	preBuild: ({ data, site }) => {
		data.startedAt = Date.now()
		console.log('Building', site.name)
	},
	preBundle: ({ pages }) => {
		console.log('Rendered pages:', pages.length)
	},
	postBuild: ({ data, pages }) => {
		console.log('Duration (ms):', Date.now() - data.startedAt)
		console.log('Pages:', pages.length)
	}
})
```

## CLI Overrides

Command line options override config values:

- `--input` and `--components` override `pagesDir` and `componentsDir`
- `--assets` overrides `publicDir`
- `--output` overrides `distDir`
- `--site-name` overrides `site.name`
- `--config` selects a specific config file
- Positional `input`/`output` match `--input`/`--output` (dev uses only `input`)

## Example

```js
import tailwindcss from '@tailwindcss/vite'

export default ({ mode }) => ({
	site: { name: 'My Docs' },
	theme: {
		root: '.',
		template: ({ PageContent, ExtraHead, ctx, withBase, HTMLRenderer, components }) => (
			<>
				{HTMLRenderer.rawHTML`<!doctype html>`}
				<html lang="en">
					<head>
						<meta charset="UTF-8" />
						<meta name="viewport" content="width=device-width" />
						<ExtraHead />
						<title>{ctx.page.title || ctx.site.name}</title>
						<link rel="icon" href="/favicon.png" />
					</head>
					<body>
						{components.Callout ? <components.Callout>Hi</components.Callout> : null}
						<PageContent />
					</body>
				</html>
			</>
		),
		components: {
			Callout: ({ children }) => <div class="callout">{children}</div>
		}
	},
	mdx: () => ({
		development: mode !== 'production'
	}),
	vite: () => ({
		server: { port: 5173 },
		plugins: [tailwindcss()]
	})
})
```
