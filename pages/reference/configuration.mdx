---
title: Configuration
description: Detailed specifications for site metadata, directory structures, themes, asset management, and CLI overrides.
weight: 2
---

# Configuration

Methanol automatically resolves configuration from the following file patterns:

```
methanol.config.{js,mjs,cjs,ts,jsx,tsx,mts,cts}
```

In the absence of a configuration file, Methanol applies sensible defaults inferred from the project's root directory.

## Configuration Schema

The configuration file must export a function that receives an execution context and returns a configuration object.

```js
export default ({ mode, root, HTMLRenderer }) => ({
	// configuration properties
})
```

Execution context properties:

- `mode`: Either `development` or `production`.
- `root`: The absolute path to the project root.
- `HTMLRenderer`: rEFui HTML utilities (including `rawHTML` and `serialize`).

## Core Options

### `root`

The project root directory. Defaults to the current working directory (CWD).

### `site`

Site-wide metadata utilized by templates:

- `site.name`: The title of the site.
- `site.logo`: Path to the logo asset (string), or `false` to disable (standard theme support).
- `site.favicon`: Path to the favicon asset (string), or `false` to disable (standard theme support).
- `site.base`: The Base Path prefix used when the site is hosted under a subpath (e.g., `'/docs/'`).
- `site.repoBase`: The base URL for the content directory within a repository, used by the standard theme to generate "Edit this page" links.

Notes:

- `site.base` is automatically normalized to include both leading and trailing slashes (e.g., `docs` becomes `'/docs/'`).
- `site.base` serves as the default Vite `base` unless `vite.base` is explicitly defined.
- In `dev` mode (`methanol dev`), `site.base` is ignored and treated as `/` to ensure module resolution consistency. Verify subpath deployments using the `build` and `serve` workflow.

### `pagefind`

Enables and configures full-text search via Pagefind. Default: `false`.

```js
pagefind: false
// or
pagefind: { enabled: true }
// or detailed configuration
pagefind: {
	enabled: true,
	excerptLength: 30,
	build: {
		outputSubdir: 'pagefind',
		verbose: true
	}
}
```

Notes:

- Properties other than `enabled` and `build` are passed directly to the Pagefind JavaScript `options()` initialization.
- The `build` object contains options specific to the build-time indexing process.

### `pwa`

Enables Methanol's integrated PWA support (powered by `vite-plugin-pwa`). Default: `false`.

```js
pwa: true
// or
pwa: false
// or detailed configuration
pwa: {
	manifest: {
		name: 'My Site',
		short_name: 'My Site'
	},
	injectManifest: {
		globPatterns: ['**/*.{js,css,html,ico,png,svg}']
	}
}
```

Notes:

- If you require bespoke PWA logic (such as custom service worker strategies), set `pwa: false` and implement your own configuration within `vite.plugins`.

### `starryNight`

Controls syntax highlighting via Starry Night (rehype-starry-night). Default: `true`.

```js
starryNight: false
// or
starryNight: true
// or detailed configuration
starryNight: {
	// options passed to rehype-starry-night
}
```

- When configured as an object, highlighting is enabled unless `enabled: false` is explicitly set.
- Per-page Frontmatter settings always take precedence over global configuration.
- The CLI flags `--highlight` and `--no-highlight` can be used to override this setting per-execution.
- Methanol automatically loads grammars for fenced code languages it encounters. Use `starryNight.grammars` only to force ambiguous mappings or to supply unsupported grammars.

### `jobs`

Controls the worker thread count used during the build pipeline. Default: `0` (auto based on page count).

```js
jobs: 0 // auto (round(ln(pageCount))), clamped to CPU cores
// or
jobs: 4
```

- The CLI flag `--jobs` (alias `-j`) overrides this setting per-execution.

### `gfm`

Enables or disables GitHub Flavored Markdown (GFM) support. Default: `true`.

When enabled, Methanol applies GFM-specific parsing, including tables, task lists, strikethrough, footnotes, and autolink literals.

```js
gfm: true
// or
gfm: false
```

### `pagesDir`

The source directory for MDX and Markdown files. Defaults to `pages`, with an automatic fallback to `docs` if `pages/` is not found.

### `componentsDir`

The directory for JSX/TSX components. Defaults to `components`.

If `pagesDir` or `componentsDir` are explicitly defined (via configuration or CLI) but do not exist, Methanol will throw an error.

### `publicDir`

The directory for static assets served at the site root (e.g., `public/foo.png` maps to `/foo.png`). Default: `public`.

Methanol automatically merges assets from the theme's `publicDir`. In the event of a path conflict, user-provided assets override theme assets.

Temporary merged assets are managed within `node_modules/.methanol/assets` (or `{pagesDir}/.methanol/assets` if `node_modules/` is unavailable).

Set `publicDir: false` to disable all static asset processing.

### `distDir`

The destination directory for production builds. Default: `dist`.

### `buildDir`

The directory for intermediate build artifacts. Default: `build`.

### `intermediateDir`

Explicit directory for intermediate HTML output (build only).

### `emitIntermediate`

Boolean. If `true`, Methanol writes intermediate HTML to the `build/` directory during the build process.

### `theme`

Configures the site's theme. This can be a theme object (see below) or a string. When a string is provided, Methanol resolves it using the following priority:
1.  **Built-in Themes:** Matches against Methanol's internal themes (e.g., `default`, `blog`).
2.  **Package Resolution:** Searches for a package named `methanol-theme-xxx` (where `xxx` is your input).

For local themes (files inside your project), import them in `methanol.config.*` and set `theme` to the imported theme object/factory.

Refer to the [Advanced Theme Guide](../advanced/themes/) for complete specifications of the theme object.

- `theme.root`: The theme's root directory (required).
- `theme.template`: The JSX function defining the HTML layout.
- `theme.components`: Default components provided by the theme.
- `theme.componentsDir`: Directory for theme-specific components.
- `theme.pagesDir`: Directory for theme-provided pages.
- `theme.publicDir`: Theme static assets (merged into `publicDir`).
- `theme.sources`: Virtual path mappings resolved by Methanol.
- `theme.mdx`: Default MDX options merged with user settings.
- `theme.vite`: Default Vite configuration merged with user settings.

### `mdx`

Customizes the MDX compilation process. Receives `{ mode, root }` and returns an MDX options object.

### `vite`

Merges custom Vite configurations. Receives `{ command, mode, root, isPreview }`.

### `preBuild` / `preBundle` / `postBundle` / `postBuild`

Hooks for extending the build pipeline.

- `preBuild`: Executes at dev server initialization and prior to the build process.
- `preBundle`: Build only; executes after page rendering but before Vite asset bundling.
- `postBundle`: Build only; executes after Vite bundling but before Pagefind indexing.
- `postBuild`: Build only; executes after the entire build process is complete.
- Hooks accept either a single function or an array of functions.
- Execution sequence: User `preBuild` → Theme `preBuild` → Render → User `preBundle` → Theme `preBundle` → Bundle → Theme `postBundle` → User `postBundle` → (Optional) Pagefind → Theme `postBuild` → User `postBuild`.

Hook Context:

- `mode`, `root`, `command`, `isDev`, `isBuild`, `isPreview`.
- `HTMLRenderer`.
- `site` (reflects the current `ctx.site` state).
- `data`: A mutable object for sharing state across the hook lifecycle.

`preBundle`, `postBundle`, and `postBuild` hooks additionally receive:

- `pagesContext`, `pages`, `pagesTree`, and `pagesByRoute`.

Example:

```js
export default () => ({
	preBuild: ({ data, site }) => {
		data.startedAt = Date.now()
		console.log('Building:', site.name)
	},
	preBundle: ({ pages }) => {
		console.log('Total rendered pages:', pages.length)
	},
	postBuild: ({ data, pages }) => {
		console.log('Build duration (ms):', Date.now() - data.startedAt)
		console.log('Final page count:', pages.length)
	}
})
```

## CLI Overrides

Command-line arguments take precedence over configuration file settings:

- `--input` and `--components` override `pagesDir` and `componentsDir`.
- `--assets` overrides `publicDir`.
- `--output` overrides `distDir`.
- `--site-name` overrides `site.name`.
- `--base` temporarily overrides `site.base` (ignored in `dev`).
- `--search`/`--no-search` override `pagefind.enabled`.
- `--pwa`/`--no-pwa` override the `pwa` toggle.
- `-v`/`--verbose` enables detailed build logging.
- `--config` specifies a non-standard configuration file.
- Positional `input`/`output` arguments map to the `--input`/`--output` flags.

## Implementation Example

```js
import tailwindcss from '@tailwindcss/vite'

export default ({ mode }) => ({
	site: { name: 'Technical Docs' },
	theme: {
		root: '.',
		template: ({ PageContent, ExtraHead, ctx, withBase, HTMLRenderer, components }) => (
			<>
				{HTMLRenderer.rawHTML`<!doctype html>`}
				<html lang="en">
					<head>
						<meta charset="UTF-8" />
						<meta name="viewport" content="width=device-width" />
						<ExtraHead />
						<title>{ctx.page.title || ctx.site.name}</title>
						<link rel="icon" href="/favicon.png" />
					</head>
					<body>
						{components.Callout ? <components.Callout>Important Note</components.Callout> : null}
						<PageContent />
					</body>
				</html>
			</>
		),
		components: {
			Callout: ({ children }) => <div class="callout-component">{children}</div>
		}
	},
	mdx: () => ({
		development: mode !== 'production'
	}),
	vite: () => ({
		server: { port: 5173 },
		plugins: [tailwindcss()]
	})
})
```
